import{_ as g,r as V,a as b,s as w,m as h,e as p,u as S,f as d,o as N,d as t,b as x,j as D}from"./index.2f24064d.js";import{u as P}from"./upload.fee60ab9.js";import{b as E}from"./user.d5a1490a.js";import{s as r}from"./function-call.38b758f1.js";import"./request.019d1f39.js";const k={style:{margin:"16px"}},A={__name:"UserDetail",setup(B){const e=V({}),s=S(),m=b([]),i=()=>{if(e.password===""){r({type:"warning",message:"Password cannot be empty"});return}let n=JSON.parse(JSON.stringify(e));E(n).then(a=>{a.code===200?(s.commit("SET_USERINFO",e),r({type:"success",message:"Update successfully"})):r({type:"danger",message:"Update failed"})}).catch(a=>{r({type:"danger",message:"Update failed"})})},c=(n,a)=>{const l=new FormData;l.append("file",n.file),P(l).then(u=>{u.code===200?(r({type:"success",message:"Upload successfully"}),a&&a(u)):r({type:"danger",message:"Upload failed"})}).catch(u=>{r({type:"danger",message:"Netword error"})})},_=n=>{c(n,a=>{e.avatar=a.data,m.value=[{url:e.avatar}]})};return w(()=>{e.username=s.state.user.username,e.password=s.state.user.password,e.email=s.state.user.email,e.phone=s.state.user.phone,e.id=s.state.user.id,e.role=s.state.user.role,e.avatar=s.state.user.avatar,m.value=[{url:e.avatar}],console.log(e)}),(n,a)=>{const l=d("van-field"),u=d("van-uploader"),f=d("van-cell-group"),v=d("van-button"),U=d("van-form"),y=d("el-container");return N(),h(y,{class:"table-container"},{default:p(()=>[t(U,{onSubmit:n.onSubmit},{default:p(()=>[t(f,{inset:""},{default:p(()=>[t(l,{modelValue:e.username,"onUpdate:modelValue":a[0]||(a[0]=o=>e.username=o),label:"Username",placeholder:"Username"},null,8,["modelValue"]),t(l,{name:"uploader",label:"Avatar"},{input:p(()=>[t(u,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=o=>m.value=o),"after-read":_},null,8,["modelValue"])]),_:1}),t(l,{type:"password",modelValue:e.password,"onUpdate:modelValue":a[2]||(a[2]=o=>e.password=o),label:"Password",placeholder:"Password"},null,8,["modelValue"]),t(l,{modelValue:e.email,"onUpdate:modelValue":a[3]||(a[3]=o=>e.email=o),label:"Email",placeholder:"Email"},null,8,["modelValue"]),t(l,{modelValue:e.phone,"onUpdate:modelValue":a[4]||(a[4]=o=>e.phone=o),label:"Phone",placeholder:"Phone"},null,8,["modelValue"])]),_:1}),x("div",k,[t(v,{round:"",block:"",type:"primary","native-type":"submit",onClick:i},{default:p(()=>[D(" Submit ")]),_:1})])]),_:1},8,["onSubmit"])]),_:1})}}},T=g(A,[["__scopeId","data-v-f5fa8647"]]);export{T as default};
