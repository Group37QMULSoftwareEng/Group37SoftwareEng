import{i as D}from"./index.f5263518.js";import{c as A,a as I,b as B}from"./coin.24a09ce5.js";import{w as V}from"./wallet.009374ac.js";import{_ as z,c as h,b as s,d as _,e as d,F as f,x as C,m as g,z as b,f as u,o as l,t as r,B as W,y as E,j as w,n as N,p as O,k as U}from"./index.1a21de82.js";import"./request.58213615.js";const F={data(){return{coins:[],rank:[],name:"BTC",walletDataList:[]}},setup(){return{formatString:function(t){if(t.length<=8)return t;var e=t.substring(0,4),c=t.substring(t.length-4),v="...";return e+v+c},compare:function(t,e){return console.log(t,e),t<e||t>e?t/e*100-100:0},geticon:function(t){return t<0?"ArrowDown":t>0?"ArrowUp":"SemiSelect"}}},mounted(){this.getCoinList(),this.getCoinRateRankList(),this.getWalletList()},methods:{getCoinList(){A().then(n=>{n.code===200&&(this.coins=n.data,this.getCoinRateList())})},getCoinRateRankList(){I().then(n=>{n.code===200&&(this.rank=n.data,this.rank.forEach(o=>{o.cur_rate=o.rate.split(",")[0],o.pre_rate=o.rate.split(",")[1]}))})},handleAddWallet(){this.$router.push({name:"CreateWallet"})},getWalletList(){let n=localStorage.getItem("user");if(!n)return;let o=JSON.parse(n);V({user_id:o.id,page:1,page_size:100}).then(i=>{if(i.code===200){let t=i.data.list;t.forEach(e=>{e.total_money=e.balance*this.coins.find(c=>c.id===e.coin_id).rate}),t.sort((e,c)=>c.total_money-e.total_money),this.walletDataList=i.data.list}else console.log("Get user wallet list failed, please try again!")})},getCoinRateList(){let n=document.getElementById("chart1");n.removeAttribute("_echarts_instance_");let o=D(n),i={dataZoom:[{type:"inside"}],tooltip:{trigger:"axis"},xAxis:{data:[]},yAxis:{},series:[{name:"Exchange Rate (USD)",type:"line",data:[]}]};B({name:this.name}).then(t=>{t.code===200&&(i.xAxis.data=t.data.map(e=>e.date),i.series[0].data=t.data.map(e=>e.rate)),o.setOption(i)}),o.setOption(i)}}},m=n=>(O("data-v-3bab2322"),n=n(),U(),n),j={class:"echart-container"},P={class:"echart-item-left"},T={class:"title"},G=m(()=>s("div",{class:"left"}," CryptoCurrency ",-1)),J={class:"right"},Z=m(()=>s("hr",{class:"hr"},null,-1)),q=m(()=>s("div",{class:"echart-canvas",id:"chart1"},null,-1)),H={class:"echart-item-right"},K=m(()=>s("div",{class:"echart-item-right-row"},"CryptoCurrency",-1)),M={class:"echart-item-right-row"},Q={class:"currency"},X={class:"rate"},Y={class:"updown"},$={key:0,class:"wallet-container"},ee=m(()=>s("div",{class:"add-desc"}," Add Wallet ",-1)),te={class:"card-header"},ae={class:"wallet-name-avatar"},se={class:"avatar"},ne={class:"wallet-name-balance"},oe={class:"wallet-name"},ie={class:"balance"},le={class:"wallet-address"},re={class:"card-text"};function ce(n,o,i,t,e,c){const v=u("el-option"),k=u("el-select"),y=u("el-icon"),L=u("Plus"),x=u("el-card"),S=u("el-avatar"),R=u("Coin");return l(),h(f,null,[s("div",j,[s("div",P,[s("div",T,[G,s("div",J,[_(k,{modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=a=>e.name=a),onChange:c.getCoinRateList,placeholder:"Select Currency",filterable:"",clearable:"",style:{width:"240px"}},{default:d(()=>[(l(!0),h(f,null,C(e.coins,a=>(l(),g(v,{key:a.name,label:a.name+" - "+a.rate+"(USD)",value:a.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])])]),Z,q]),s("div",H,[K,(l(!0),h(f,null,C(e.rank,a=>(l(),h("div",M,[s("div",Q,r(a.name),1),s("div",X," $"+r(a.cur_rate),1),s("div",Y,[s("div",{class:W(a.cur_rate>a.pre_rate?"up":"down")},[_(y,null,{default:d(()=>[(l(),g(E(t.geticon(t.compare(a.cur_rate,a.pre_rate)))))]),_:2},1024),w(" "+r(t.compare(a.cur_rate,a.pre_rate).toFixed(2))+"% ",1)],2)])]))),256))])]),this.$store.state.user.role===1?(l(),h("div",$,[e.walletDataList.length===0?(l(),g(x,{key:0,class:"wallet-item add-wallet",onClick:c.handleAddWallet},{default:d(()=>[s("div",null,[_(y,{color:"#b9b3b3",size:30},{default:d(()=>[_(L)]),_:1})]),ee]),_:1},8,["onClick"])):b("",!0),e.walletDataList.length>0?(l(!0),h(f,{key:1},C(e.walletDataList,a=>(l(),g(x,{class:"wallet-item",style:N({backgroundColor:"rgba(21,133,241,0.89)"})},{header:d(()=>[s("div",te,[s("div",ae,[s("div",se,[_(S,{size:50},{default:d(()=>[w(r(e.coins.find(p=>p.id===a.coin_id).name),1)]),_:2},1024)]),s("div",ne,[s("div",oe,r(a.name),1),s("div",ie,r(a.balance)+" "+r(e.coins.find(p=>p.id===a.coin_id).name),1)])]),s("div",le,[w(" $"+r(a.balance*e.coins.find(p=>p.id===a.coin_id).rate)+" ",1),_(y,null,{default:d(()=>[_(R)]),_:1})])])]),default:d(()=>[s("p",re,r(a.description),1)]),_:2},1032,["style"]))),256)):b("",!0)])):b("",!0)],64)}const me=z(F,[["render",ce],["__scopeId","data-v-3bab2322"]]);export{me as default};
