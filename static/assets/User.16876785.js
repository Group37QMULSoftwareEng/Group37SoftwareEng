import{_ as E,r as I,s as P,m as c,e as t,u as C,f as s,o as _,d as a,z as i,j as w,E as p,p as A,k as B,b as f}from"./index.1a21de82.js";import{u as D}from"./upload.7655db22.js";import{b as F}from"./user.3dcdea04.js";import"./request.58213615.js";const O=m=>(A("data-v-7c4107a9"),m=m(),B(),m),J=O(()=>f("div",{class:"el-upload__text"},[w(" Drag and drop the file here "),f("em",null," or click Upload ")],-1)),M={__name:"User",setup(m){const e=I({}),r=C(),h=()=>{if(e.password===""){p.warning("Password cannot be empty");return}let u=JSON.parse(JSON.stringify(e));F(u).then(o=>{o.code===200?(r.commit("SET_USERINFO",e),p.success("Update successfully")):p.error(o.msg)}).catch(o=>{console.log(o),p.error("Update failed")})},U=(u,o)=>{const d=new FormData;d.append("file",u.file),D(d).then(l=>{l.code===200?(p.success("Upload success"),o&&o(l)):p.error("Upload failed")}).catch(l=>{p.error("Network error")})},v=u=>{U(u,o=>{e.avatar=o.data})};return P(()=>{e.username=r.state.user.username,e.password=r.state.user.password,e.email=r.state.user.email,e.phone=r.state.user.phone,e.id=r.state.user.id,e.role=r.state.user.role,e.avatar=r.state.user.avatar,console.log(e)}),(u,o)=>{const d=s("el-input"),l=s("el-form-item"),V=s("upload-filled"),g=s("el-icon"),b=s("el-image"),y=s("el-upload"),x=s("el-button"),S=s("el-form"),N=s("el-row"),k=s("el-container");return _(),c(k,{class:"table-container"},{default:t(()=>[a(N,null,{default:t(()=>[a(S,{model:e,"label-width":"140px"},{default:t(()=>[a(l,{label:"Username",prop:"username"},{default:t(()=>[a(d,{modelValue:e.username,"onUpdate:modelValue":o[0]||(o[0]=n=>e.username=n),placeholder:"Username"},null,8,["modelValue"])]),_:1}),a(l,{label:"Avatar",prop:"cover"},{default:t(()=>[a(y,{class:"upload-demo",drag:"",style:{"margin-top":"10px"},"http-request":v},{default:t(()=>[e.avatar?i("",!0):(_(),c(g,{key:0,class:"el-icon--upload"},{default:t(()=>[a(V)]),_:1})),e.avatar?(_(),c(b,{key:1,style:{width:"20%",height:"auto"},src:e.avatar,fit:"contain"},null,8,["src"])):i("",!0),J]),_:1})]),_:1}),a(l,{label:"Password",prop:"password"},{default:t(()=>[a(d,{type:"password",modelValue:e.password,"onUpdate:modelValue":o[1]||(o[1]=n=>e.password=n),"show-password":"",placeholder:"Password"},null,8,["modelValue"])]),_:1}),a(l,{label:"Email",prop:"email"},{default:t(()=>[a(d,{modelValue:e.email,"onUpdate:modelValue":o[2]||(o[2]=n=>e.email=n),placeholder:"Email"},null,8,["modelValue"])]),_:1}),a(l,{label:"Phone",prop:"phone"},{default:t(()=>[a(d,{modelValue:e.phone,"onUpdate:modelValue":o[3]||(o[3]=n=>e.phone=n),placeholder:"Phone"},null,8,["modelValue"])]),_:1}),a(l,null,{default:t(()=>[a(x,{type:"primary",onClick:o[4]||(o[4]=n=>h())},{default:t(()=>[w("Submit")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})}}},R=E(M,[["__scopeId","data-v-7c4107a9"]]);export{R as default};
