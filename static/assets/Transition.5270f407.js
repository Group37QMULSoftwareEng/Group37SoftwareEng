import{_ as K,a as T,r as O,s as $,m as _,e as l,E as n,f as r,o as i,d as s,c as A,x as I,b as m,t as q,i as y,j as p,F as L,z as H,u as J,l as Q,C as X,p as Y,k as Z}from"./index.1a21de82.js";import{w as ee}from"./wallet.009374ac.js";import{c as te}from"./coin.24a09ce5.js";import{t as ae}from"./transaction.08b91bb4.js";import{w as le,a as se,b as oe}from"./address.a2675a0d.js";import"./request.58213615.js";const S=c=>(Y("data-v-6bbe1494"),c=c(),Z(),c),ne=S(()=>m("h1",{class:"title"},"Create Transition",-1)),re=S(()=>m("h5",{class:"description"},"Inter-user transactions",-1)),de={style:{float:"left","margin-right":"10px"}},ie={style:{float:"right",color:"#8492a6","font-size":"13px"}},ce={__name:"Transition",setup(c){const u=J(),z=Q(),f=T([]),h=T([]),e=O({}),B=async()=>{let o=await te();o.code===200?h.value=o.data:n.error("Get coin list failed, please try again!")},W=async()=>{const o=await ee({user_id:u.state.user.id,page:1,page_size:100});o.code===200?f.value=o.data.list:n.error("Get user wallet list failed, please try again!")},D=async()=>{var a;if(e.user_id=u.state.user.id,e.to_wallet_id===e.from_wallet_id){n.error("Please select different wallet!");return}if(e.amount<=0||e.amount===""){n.error("Please enter the correct amount!");return}if(e.amount>((a=f.value.find(g=>g.hash_id===e.from_wallet_id))==null?void 0:a.balance)){n.error("Insufficient balance!");return}let o=await ae(e);o.code===200?(e.to_wallet_id="",e.from_wallet_id="",e.amount="",e.description="",n.success("Create Transaction successful!")):n.error(o.msg)},U=()=>{z.push({name:"WalletTransfer"})},w=async()=>{const o=await le({user_id:u.state.user.id});o.code===200&&(addressList.value=o.data.list)},E=async()=>{const o=await X.prompt("Please input address remark","Tips",{confirmButtonText:"OK",cancelButtonText:"Cancel"});if(!o.value){n.error("Please input address remark!");return}const a=await se({user_id:u.state.user.id,remark:o.value,address:e.to_wallet_id});console.log(a),a.code===200?(w(),n.success("Save address successful!")):n.error(a.msg)},F=async o=>{const a=await oe(o.id);a.code===200?(w(),n.success("Delete address successful!")):n.error(a.msg)};return $(()=>{B(),W(),w()}),(o,a)=>{const g=r("el-header"),b=r("el-input"),k=r("el-tag"),x=r("el-option"),V=r("el-select"),d=r("el-form-item"),C=r("van-button"),M=r("el-form"),N=r("el-col"),P=r("el-row"),j=r("el-main"),G=r("el-container");return i(),_(G,null,{default:l(()=>[s(j,null,{default:l(()=>[s(g,null,{default:l(()=>[ne,re]),_:1}),s(P,{type:"flex",justify:"center"},{default:l(()=>[s(N,{span:22},{default:l(()=>[s(M,{ref:"transferFormRef",model:e,class:"login-form","auto-complete":"on","label-position":"left"},{default:l(()=>[s(d,{prop:"hash_id"},{default:l(()=>[s(b,{modelValue:e.to_wallet_id,"onUpdate:modelValue":a[0]||(a[0]=t=>e.to_wallet_id=t),size:"large",placeholder:"Wallet Address",tabIndex:"-1"},null,8,["modelValue"]),s(V,{modelValue:e.to_wallet_id,"onUpdate:modelValue":a[1]||(a[1]=t=>e.to_wallet_id=t),placeholder:"Wallet Address",clearable:"",style:{"margin-right":"5px","margin-top":"10px",width:"150px"}},{default:l(()=>[(i(!0),A(L,null,I(o.addressList,t=>(i(),_(x,{key:t.id,label:t.address+" - "+t.remark,value:t.address},{default:l(()=>[m("span",de,q(t.address),1),m("span",ie,[s(k,{type:"danger",onClick:y(v=>F(t),["stop"])},{default:l(()=>[p("Delete")]),_:2},1032,["onClick"])])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),e.to_wallet_id?(i(),_(k,{key:0,style:{"margin-top":"5px"},onClick:E},{default:l(()=>[p(" Save address ")]),_:1})):H("",!0)]),_:1}),s(d,{prop:"name"},{default:l(()=>[s(V,{modelValue:e.from_wallet_id,"onUpdate:modelValue":a[2]||(a[2]=t=>e.from_wallet_id=t),size:"large",placeholder:"Select Currency",filterable:"",clearable:""},{default:l(()=>[(i(!0),A(L,null,I(f.value,t=>{var v;return i(),_(x,{key:t.id,label:t.name+" - "+((v=h.value.find(R=>R.id===t.coin_id))==null?void 0:v.name)+" - (balance:"+t.balance+")",value:t.hash_id},null,8,["label","value"])}),128))]),_:1},8,["modelValue"])]),_:1}),s(d,{prop:"amount"},{default:l(()=>[s(b,{modelValue:e.amount,"onUpdate:modelValue":a[3]||(a[3]=t=>e.amount=t),placeholder:"Amount",size:"large",tabIndex:"-1"},null,8,["modelValue"])]),_:1}),s(d,{prop:"description"},{default:l(()=>[s(b,{type:"textarea",rows:"5",modelValue:e.description,"onUpdate:modelValue":a[4]||(a[4]=t=>e.description=t),placeholder:"Transaction Description (optional)",size:"large",tabIndex:"-1"},null,8,["modelValue"])]),_:1}),s(d,null,{default:l(()=>[s(C,{type:"primary",round:"",block:"","native-type":"submit",onClick:y(D,["prevent"])},{default:l(()=>[p(" Transfer ")]),_:1},8,["onClick"])]),_:1}),s(d,null,{default:l(()=>[s(C,{round:"",block:"","native-type":"submit",onClick:y(U,["prevent"])},{default:l(()=>[p(" Wallet Transfer ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})]),_:1})}}},ge=K(ce,[["__scopeId","data-v-6bbe1494"]]);export{ge as default};
