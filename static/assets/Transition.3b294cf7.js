import{_ as O,a as h,r as $,s as q,m as _,e as l,E as n,f as r,o as i,d as s,c as S,x as L,b as m,t as H,i as b,j as p,F as z,z as J,u as Q,l as X,C as Y,p as Z,k as ee}from"./index.2f24064d.js";import{a as te}from"./wallet.49f100df.js";import{c as ae}from"./coin.cb3c48a8.js";import{t as le}from"./transaction.d95307bf.js";import{w as se,a as oe,b as ne}from"./address.d8b49890.js";import"./request.019d1f39.js";const B=c=>(Z("data-v-76d6d679"),c=c(),ee(),c),re=B(()=>m("h1",{class:"title"},"Create Transition",-1)),de=B(()=>m("h5",{class:"description"},"Inter-user transactions",-1)),ie={style:{float:"left","margin-right":"10px"}},ce={style:{float:"right",color:"#8492a6","font-size":"13px"}},ue={__name:"Transition",setup(c){const u=Q(),W=X(),f=h([]),k=h([]),e=$({}),x=h([]),D=async()=>{let o=await ae();o.code===200?k.value=o.data:n.error("Get coin list failed, please try again!")},V=async()=>{const o=await te({user_id:u.state.user.id,page:1,page_size:100});o.code===200?f.value=o.data.list:n.error("Get user wallet list failed, please try again!")},U=async()=>{var a;if(e.user_id=u.state.user.id,e.to_wallet_id===e.from_wallet_id){n.error("Please select different wallet!");return}if(e.amount<=0||e.amount===""){n.error("Please enter the correct amount!");return}if(e.amount>((a=f.value.find(g=>g.hash_id===e.from_wallet_id))==null?void 0:a.balance)){n.error("Insufficient balance!");return}let o=await le(e);o.code===200?(e.to_wallet_id="",e.from_wallet_id="",e.amount="",e.description="",await V(),n.success("Create Transaction successful!")):n.error(o.msg)},E=()=>{W.push({name:"WalletTransfer"})},w=async()=>{const o=await se({user_id:u.state.user.id});o.code===200&&(x.value=o.data.list)},F=async()=>{const o=await Y.prompt("Please input address remark","Tips",{confirmButtonText:"OK",cancelButtonText:"Cancel"});if(!o.value){n.error("Please input address remark!");return}const a=await oe({user_id:u.state.user.id,remark:o.value,address:e.to_wallet_id});console.log(a),a.code===200?(w(),n.success("Save address successful!")):n.error(a.msg)},M=async o=>{const a=await ne(o.id);a.code===200?(w(),n.success("Delete address successful!")):n.error(a.msg)};return q(()=>{D(),V(),w()}),(o,a)=>{const g=r("el-header"),v=r("el-input"),C=r("el-tag"),T=r("el-option"),A=r("el-select"),d=r("el-form-item"),I=r("van-button"),N=r("el-form"),P=r("el-col"),j=r("el-row"),G=r("el-main"),R=r("el-container");return i(),_(R,null,{default:l(()=>[s(G,null,{default:l(()=>[s(g,null,{default:l(()=>[re,de]),_:1}),s(j,{type:"flex",justify:"center"},{default:l(()=>[s(P,{span:22},{default:l(()=>[s(N,{ref:"transferFormRef",model:e,class:"login-form","auto-complete":"on","label-position":"left"},{default:l(()=>[s(d,{prop:"hash_id"},{default:l(()=>[s(v,{modelValue:e.to_wallet_id,"onUpdate:modelValue":a[0]||(a[0]=t=>e.to_wallet_id=t),size:"large",placeholder:"Wallet Address",tabIndex:"-1"},null,8,["modelValue"]),s(A,{modelValue:e.to_wallet_id,"onUpdate:modelValue":a[1]||(a[1]=t=>e.to_wallet_id=t),placeholder:"Wallet Address",clearable:"",style:{"margin-right":"5px","margin-top":"10px",width:"150px"}},{default:l(()=>[(i(!0),S(z,null,L(x.value,t=>(i(),_(T,{key:t.id,label:t.address+" - "+t.remark,value:t.address},{default:l(()=>[m("span",ie,H(t.remark),1),m("span",ce,[s(C,{type:"danger",onClick:b(y=>M(t),["stop"])},{default:l(()=>[p("Delete")]),_:2},1032,["onClick"])])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),e.to_wallet_id?(i(),_(C,{key:0,style:{"margin-top":"5px"},onClick:F},{default:l(()=>[p(" Save address ")]),_:1})):J("",!0)]),_:1}),s(d,{prop:"name"},{default:l(()=>[s(A,{modelValue:e.from_wallet_id,"onUpdate:modelValue":a[2]||(a[2]=t=>e.from_wallet_id=t),size:"large",placeholder:"Select Currency",filterable:"",clearable:""},{default:l(()=>[(i(!0),S(z,null,L(f.value,t=>{var y;return i(),_(T,{key:t.id,label:t.name+" - "+((y=k.value.find(K=>K.id===t.coin_id))==null?void 0:y.name)+" - (balance:"+t.balance+")",value:t.hash_id},null,8,["label","value"])}),128))]),_:1},8,["modelValue"])]),_:1}),s(d,{prop:"amount"},{default:l(()=>[s(v,{modelValue:e.amount,"onUpdate:modelValue":a[3]||(a[3]=t=>e.amount=t),placeholder:"Amount",size:"large",tabIndex:"-1"},null,8,["modelValue"])]),_:1}),s(d,{prop:"description"},{default:l(()=>[s(v,{type:"textarea",rows:"5",modelValue:e.description,"onUpdate:modelValue":a[4]||(a[4]=t=>e.description=t),placeholder:"Transaction Description (optional)",size:"large",tabIndex:"-1"},null,8,["modelValue"])]),_:1}),s(d,null,{default:l(()=>[s(I,{type:"primary",round:"",block:"","native-type":"submit",onClick:b(U,["prevent"])},{default:l(()=>[p(" Transfer ")]),_:1},8,["onClick"])]),_:1}),s(d,null,{default:l(()=>[s(I,{round:"",block:"","native-type":"submit",onClick:b(E,["prevent"])},{default:l(()=>[p(" Wallet Transfer ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})]),_:1})}}},ve=O(ue,[["__scopeId","data-v-76d6d679"]]);export{ve as default};
